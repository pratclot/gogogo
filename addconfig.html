<!doctype html>

<html lang="en">

<head>

<meta charset="utf-8">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

<script>

$(document).ready(function(){

var checkedTS;

$('#serverTS').click(function(){

var data2 = $.ajax({

url: 'http://'+window.location.hostname+':9000/getServerTS',
async: false

}).responseText.split('\n');

	popup = '<div id="popup"><input ';

	for (var i=0; i<data2.length-3; i++) {
		popup += 'type="checkbox" class="chkbx" value="'+data2[i]+'">'+data2[i]+'<br /><input ';
	};

	popup += 'type="checkbox" class="chkbx" value="'+data2[i]+'">'+data2[i]+'<button type="button"id="serverTSsubmit">Ok</button></div>';

	$(popup).dialog();
if (typeof checkedTS != 'undefined'){
$.each(checkedTS,function(index,value){
	$('.chkbx[value="'+value+'"]').prop('checked', true);
});
};

$('#serverTSsubmit').click(function(){

	checkedTS = $('.chkbx:checked').map(function() {
		return this.value;
	}).get();
	$('#popup').remove();
	$(this).closest(".ui-dialog-content").dialog("close");
	alert(checkedTS);
	$('[name="serverTS"]').val(checkedTS);
});

$('#serverTSsubmit').click(function(){
	});

// from http://stackoverflow.com/questions/19766044/best-way-to-get-all-selected-checkboxes-values-in-jquery

});

$('#addConfigForm').submit(function(event){

event.preventDefault();


});

});

</script>

</head>

<body> 

<div style="text-align:center;margin:auto;">

<form id="addConfigForm">
	<p id='serverTS'>Server TS<input type="text" name="serverTS"></p>
	<p id='clientTS'>Client TS<input type="text" name="clientTS"></p>
	<input type="submit">
</form>

</div>

</body>

</html>

